function GestureAdapter(a,b){var c=this;return c.destroy=function(){c.isTouched?(c._el.removeEventListener("touchstart",this),c._el.removeEventListener("touchend",this),c._el.removeEventListener("touchmove",this),c._el.removeEventListener("touchcancel",this)):(clearTimeout(c.mouseWheelTimeout),c._el.removeEventListener("mousedown",this),c._el.removeEventListener("mouseup",this),c._el.removeEventListener("mousemove",this),c._el.removeEventListener("mouseout",this),c._el.removeEventListener("mousewheel",c),c._el.removeEventListener("DOMMouseScroll",c)),delete c._el,delete c._listener},c._el=a,c._listener=b,c._tmpCoords={},c.isTouched?(c._el.addEventListener("touchstart",c,!1),c._el.addEventListener("touchend",c,!1),c._el.addEventListener("touchmove",c,!1),c._el.addEventListener("touchcancel",c,!1)):(c._el.addEventListener("mousedown",c,!1),c._el.addEventListener("mouseup",c,!1),c._el.addEventListener("mousemove",c,!1),c._el.addEventListener("mouseout",c,!1),c._el.addEventListener("mouseover",c,!1),c._el.addEventListener("mousewheel",c,!1),c._el.addEventListener("DOMMouseScroll",c,!1)),c}GestureAdapter.prototype=function(){function a(a,b){if(a.timeStamp-b.preLastMove.timeStamp>10){var c=q(a,b);if(!c)return;b.lastMove.screenX=b.preLastMove.screenX,b.lastMove.screenY=b.preLastMove.screenY,b.lastMove.timeStamp=b.preLastMove.timeStamp,b.preLastMove.screenX=c.screenX,b.preLastMove.screenY=c.screenY,b.preLastMove.timeStamp=a.timeStamp}}function b(a,b,c,d){return Math.abs(a-c)>Math.abs(b-d)?m.horizontal:m.vertical}function c(a,b,c){var d=q(b,c),e=o.get();d&&(e.type=a,e.clientX=d.clientX,e.clientY=d.clientY,e.screenX=d.screenX,e.screenY=d.screenY,e.timeStamp=b.timeStamp,e.origin=b,c._listener.handleEvent(e))}function d(a,b,c,d,e,f){return Math.abs(a-d)>Math.abs(b-e)?(d-a)/(f-c):(e-b)/(f-c)}function e(a,b,c,d){return Math.pow((c-a)*(c-a)+(d-b)*(d-b),.5)}function f(a,c){var f,g=q(a,c);g&&100*Math.abs(e(c.lastMove.screenX,c.lastMove.screenY,g.screenX,g.screenY)/(a.timeStamp-c.lastMove.timeStamp))>>0>0&&(f=p.get(),f.type=m.fling,f.velocity=e(c.startX,c.startY,g.screenX,g.screenY)/(a.timeStamp-c.timeStamp),f.direction=b(c.startX,c.startY,g.screenX,g.screenY),f.speed=d(c.startX,c.startY,c.timeStamp,g.screenX,g.screenY,a.timeStamp),f.start.screenX=c.startX,f.start.screenY=c.startY,f.start.clientX=c.startClientX,f.start.clientY=c.startClientY,f.start.timeStamp=c.timeStamp,f.end.screenX=g.screenX,f.end.screenY=g.screenY,f.end.clientX=g.clientX,f.end.clientY=g.clientY,f.end.timeStamp=a.timeStamp,c._listener.handleEvent(f))}function g(a,b){var d=q(a,b);d&&(b.startX=d.screenX,b.startY=d.screenY,b.startClientX=d.clientX,b.startClientY=d.clientY,b.timeStamp=a.timeStamp,b.moved=!1,b.isDown=!0,b.touchStartTime=a.timeStamp,b.lastMove=b.lastMove||{},b.preLastMove=b.preLastMove||{},b.lastMove.screenX=b.preLastMove.screenX=0,b.lastMove.screenY=b.preLastMove.screenY=0,b.lastMove.timeStamp=b.preLastMove.timeStamp=a.timeStamp,c(m.pointerdown,a,b))}function h(b,d){var e=q(b,d);e&&d.isDown&&(a(b,d),c(m.pointermove,b,d),(Math.abs(e.screenY-d.startY)>10||Math.abs(e.screenX-d.startX)>10)&&(d.moved=!0))}function i(a,b){var d=a.timeStamp-b.touchStartTime;b.isDown&&(b.isDown=!1,b.moved?f(a,b):300>=d?c(m.tap,a,b):c(m.longtap,a,b),c(m.pointerup,a,b))}function j(a,b){clearTimeout(b.mouseOutTimeout)}function k(a,b){b.mouseOutTimeout=setTimeout(function(){i(a,b)},10)}function l(a,b){var d=10*((a.wheelDelta||-a.detail)>0?1:-1);clearTimeout(b.mouseWheelTimeout),a.preventDefault(),a.stopPropagation(),a={clientX:a.clientX,clientY:a.clientY,screenX:a.screenX,screenY:0,timeStamp:a.timeStamp,preventDefault:function(){},stopPropagation:function(){}},b.isDown||(b.isDown=!0,b.moved=!0,b.useMouseWheel=!0,b.currentWheelPosition=0,b.acceleration=d,g(a,b)),b.acceleration*=1.2,b.currentWheelPosition+=b.acceleration,a.screenY=b.currentWheelPosition,h(a,b),b.mouseWheelTimeout=setTimeout(function(){c(m.pointerup,a,b),b.isDown=!1,b.moved=!1,b.useMouseWheel=!1},200)}var m={touchstart:"touchstart",touchmove:"touchmove",touchend:"touchend",touchleave:"touchleave",touchcancel:".touchcancel",mousedown:"mousedown",mousemove:"mousemove",mouseup:"mouseup",mouseover:"mouseover",mouseout:"mouseout",mousewheel:"mousewheel",wheel:"DOMMouseScroll",horizontal:"horizontal",vertical:"vertical",fling:"fling",tap:"tap",longtap:"longtap",pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup"},n="ontouchstart"in window,o=new Pool(function(){},100),p=new Pool(function(){this.start={},this.end={}},10),q=function(){return n?function(a,b){var c,d,e;if(a.type===m.touchstart){if(a.touches.length>1)return;c=a.touches[0],b.touchID=a.touches[0].identifier}else{for(d=0,e=a.changedTouches.length;e>d&&(c=a.changedTouches[d],c.identifier!==b.touchID);d++);if(c.identifier!==b.touchID)return}return b._tmpCoords.screenX=c.screenX,b._tmpCoords.screenY=c.screenY,b._tmpCoords.clientX=c.clientX,b._tmpCoords.clientY=c.clientY,b._tmpCoords}:function(a,b){return b._tmpCoords.screenX=a.screenX,b._tmpCoords.screenY=a.screenY,b._tmpCoords.clientX=a.clientX,b._tmpCoords.clientY=a.clientY,b._tmpCoords}}();return{isTouched:n,handleEvent:function(a){switch(a.type){case m.touchmove:case m.mousemove:this.useMouseWheel||h(a,this);break;case m.touchstart:case m.mousedown:g(a,this);break;case m.touchend:case m.touchleave:case m.touchcancel:case m.mouseup:i(a,this);break;case m.mouseover:j(a,this);break;case m.mouseout:k(a,this);break;case m.wheel:case m.mousewheel:l(a,this)}}}}();