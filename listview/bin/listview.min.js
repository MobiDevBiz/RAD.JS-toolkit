function ListView(a,b,c){function d(){var a,c,d,e=b.getElementsCount();return 0===e?0:(a=b.getElement(0,null,{width:0,height:0}),d=document.createElement("div"),d.style.position="absolute",d.className=A,d.appendChild(a),o.appendChild(d),c=d.getBoundingClientRect(),r=c.height,q=c.width,o.removeChild(d),"vertical"===z?r:q)}function e(){var a=document.createElement("div");a.style.position="absolute",a.style.height=r+"px",a.style.width=q+"px",a.style.webkitFontSmoothing="antialiased",a.className=A,w&&a.addEventListener(c.eventListener.type,w,c.eventListener.useCapture),this.wrapper=a,this.item=null,this.position=null,this.index=0,this.timeout=null,this.handler={width:0,height:0},this.taskTimestamp=0}function f(){if(G.length>1){var a,b=G.pop(),d=b.wrapper.parentNode;d.removeChild(b.wrapper),w&&b.wrapper.removeEventListener(c.eventListener.type,w);for(a in b)b.hasOwnProperty(a)&&(b[a]=null);v=setTimeout(f,150)}}function g(a){return setTimeout(function(){a.wrapper.style[s]="vertical"!==z?"translate3d(0, 999999px, 0)":"translate3d(999999px, 0, 0)"},100)}function h(a){var c,d,e=window.performance.now();for(c=F.length-1;c>=0;c--)if(d=F[c],0!==d.taskTimestamp&&(e-d.taskTimestamp>H||a)){if(d.index<b.getElementsCount()){var f=b.getElement(d.index,d.item,d.handler);d.wrapper.appendChild(f),d.item=f,B&&(d.item.style[t]="opacity 150ms ease-in",d.item.style.opacity=1)}d.taskTimestamp=0}}function i(a){E[1]=a.position,a.wrapper.style[s]=E.join(""),a.wrapper.setAttribute("data-item",a.index),B&&a.item&&(a.item.style[t]="none",a.item.style.opacity=0),a.taskTimestamp=window.performance.now()}function j(a){for(var b,c,d=K;d>=0&&(d+1+C)*D>-a;)c=G.pop()||new e,c.handler.width=q,c.handler.height=r,c.position=d*D,c.index=d,b=c.wrapper,b.parentNode?clearTimeout(c.timeout):o.appendChild(b),c.timeout=i(c),d--,K=d,F.unshift(c)}function k(a){var c,d,f=b.getElementsCount(),g=J,h=J*D+a;for(g;f>g&&h<p._ParentSize+C*D;g++)h+=D,c=G.pop()||new e,c.handler.width=q,c.handler.height=r,c.position=g*D,c.index=g,d=c.wrapper,d.parentNode?clearTimeout(c.timeout):o.appendChild(d),c.timeout=i(c),F.push(c);J=g}function l(a){var b,c,d;for(b=0;b<F.length;b++)if(b===a){for(d=F[b],c=b;c<F.length-1;c++)F[c]=F[c+1];return F.length=F.length-1,d}}function m(a){var b,c,d,e;for(c=F.length-1;c>=0;c--)b=F[c],d=b.position>p._ParentSize-a+C*D,e=b.position+D*(1+C)<-a,(e||d)&&(b.timeout=g(b),G.push(l(c)),d?J=b.index:K<b.index&&(K=b.index))}function n(a){m(a),p._ParentSize-a>J*D&&k(a),(K+1)*D>-a&&j(a)}var o,p,q,r,s,t,u,v,w,x,y={},z=c&&c.direction?c.direction:"vertical",A=c?c.itemClass:"",B=!!(c?c.useOpacity:!1),C=c&&"number"==typeof c.stealthCount?Math.abs(c.stealthCount):0,D=0,E=[],F=[],G=[],H=1e3/(c&&c.requiredFPS?c.requiredFPS:20),I=0,J=0,K=-1,L=!1,M={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup"};return s=addVendorPrefix("transform"),t=addVendorPrefix("transition"),"vertical"===z?(E[0]="translate3d(0, ",E[2]="px, 0) scale(1)"):(E[0]="translate3d(",E[2]="px, 0, 0) scale(1)"),o=document.createElement("div"),o.style.width="100%",o.style.height="100%",a.insertBefore(o,a.firstChild),p=new ScrollView(a,c),c&&c.eventListener&&(w="object"==typeof c.eventListener.listener?function(a){a.type!==c.eventListener.type||L||c.eventListener.listener.handleEvent(a)}:function(a){a.type!==c.eventListener.type||L||c.eventListener.listener(a)}),p._calculateMaxScroll=function(){var a,c,e=q,f=r,i=d(),j=b.getElementsCount();if(K>j-1||0>K){for(K=j>0&&0>K?-1:j-1,J=K+1,c=F.length-1;c>=0;c--)a=F[c],(a.index<K||a.index>=J)&&(a.timeout=g(a),G.push(l(c)));p.scrollPosition=-Math.max(0,K)*i}if(e!==q||f!==r){var k,m;for(p.scrollPosition=-(K+1)*i,D=i,c=F.length-1;c>=0;c-=1)a=F[c],m=a.wrapper,k=a.index*D,E[1]=k,m.style.height=r+"px",m.style.width=q+"px",m.style[s]=E.join(""),a.position=k,a.handler.width=q,a.handler.height=r;for(c=G.length-1;c>=0;c-=1)a=G[c],a.handler.width=q,a.handler.height=r,m=a.wrapper,m.style.height=r+"px",m.style.width=q+"px"}for(c=F.length-1;c>=0;c-=1)a=F[c],b.getElement(a.index,a.item,a.handler);p._MaxScroll=D*b.getElementsCount()-p._ParentSize,p.setPosition(p.scrollPosition,!0),h(!0)},y.setPosition=p.setPosition,p.setPosition=function(a,b){clearTimeout(v),y.setPosition.apply(p,arguments),u=window.performance.now(),(u-I>H||b)&&(n(a),h(),I=u),v=setTimeout(f,1e3)},y.handleEvent=p.handleEvent,p.handleEvent=function(a){switch(y.handleEvent.apply(p,arguments),a.type){case M.pointerdown:n(p.scrollPosition),h(!0),L=!1,x=z===M.vertical?a.screenY:a.screenX;break;case M.pointermove:(z===M.vertical?a.screenY:a.screenX)-x>10&&(L=!0)}},p.refresh(),n(0),p}