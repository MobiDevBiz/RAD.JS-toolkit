function ListView(a,b,c){function d(){var a,c,d,f=b.getElementsCount(),g=new e;return 0===f?0:(a=b.getElement(g.index,g.item,g.handler),d=g.wrapper,d.appendChild(a),n.appendChild(d),c=d.getBoundingClientRect(),q=c.height,p=c.width,n.removeChild(d),"vertical"===v?q:p)}function e(){var a=document.createElement("div");a.style.position="absolute",a.style.height=q+"px",a.style.width=p+"px",a.style.webkitFontSmoothing="antialiased",a.className=w,this.wrapper=a,this.item=null,this.position=null,this.index=0,this.timeout=null,this.handler={width:0,height:0}}function f(){if(A.length>1){var a,b=A.pop(),c=b.wrapper.parentNode;c.removeChild(b.wrapper);for(a in b)b.hasOwnProperty(a)&&(b[a]=null);t=setTimeout(f,150)}}function g(a){return setTimeout(function(){a.wrapper.style[r]="vertical"!==v?"translate3d(0, 999999px, 0)":"translate3d(999999px, 0, 0)"},100)}function h(a){var c=a.index,d=a.wrapper,e=a.handler;if(y[1]=a.position,a.wrapper.style[r]=y.join(""),a.wrapper.setAttribute("data-item",a.index),c<b.getElementsCount()){var f=b.getElement(c,a.item,e);d.appendChild(f),a.item=f}}function i(a){for(var b,c,d=E;d>=0&&(d+1)*x>-a;)c=A.pop()||new e,c.handler.width=p,c.handler.height=q,c.position=d*x,c.index=d,b=c.wrapper,b.parentNode?clearTimeout(c.timeout):n.appendChild(b),c.timeout=h(c),d--,E=d,z.unshift(c)}function j(a){var c,d,f=b.getElementsCount(),g=D,i=D*x+a;for(g;f>g&&i<o._ParentSize;g++)i+=x,c=A.pop()||new e,c.handler.width=p,c.handler.height=q,c.position=g*x,c.index=g,d=c.wrapper,d.parentNode?clearTimeout(c.timeout):n.appendChild(d),c.timeout=h(c),z.push(c);D=g}function k(a){var b,c,d;for(b=0;b<z.length;b++)if(b===a){for(d=z[b],c=b;c<z.length-1;c++)z[c]=z[c+1];return z.length=z.length-1,d}}function l(a){var b,c,d,e;for(c=z.length-1;c>=0;c--)b=z[c],d=b.position>o._ParentSize-a,e=b.position+2*x<-a,(e||d)&&(b.timeout=g(b),A.push(k(c)),d?D=b.index:E<b.index&&(E=b.index))}function m(a){l(a),o._ParentSize-a>D*x&&j(a),(E+1)*x>-a&&i(a)}var n,o,p,q,r,s,t,u={},v=c&&c.direction?c.direction:"vertical",w=c?c.itemClass:"",x=0,y=[],z=[],A=[],B=1e3/(c&&c.requiredFPS?c.requiredFPS:20),C=0,D=0,E=-1;return r=addVendorPrefix("transform"),"vertical"===v?(y[0]="translate3d(0, ",y[2]="px, 0) scale(1)"):(y[0]="translate3d(",y[2]="px, 0, 0) scale(1)"),n=document.createElement("div"),n.style.width="100%",n.style.height="100%",a.insertBefore(n,a.firstChild),o=new ScrollView(a,c),o._calculateMaxScroll=function(){var a,c,e=p,f=q,g=d(),h=b.getElementsCount();if(D=Math.min(h,D),E>=D?(E=D-1,o.scrollPosition=-Math.max(0,E)*g):(e!==p||f!==q)&&(o.scrollPosition=-(E+1)*g),D=Math.max(E+z.length,0),e!==p||f!==q){var i,j;for(x=g,c=z.length-1;c>=0;c-=1)a=z[c],j=a.wrapper,i=a.index*x,y[1]=i,j.style.height=q+"px",j.style.width=p+"px",j.style[r]=y.join(""),a.position=i,a.handler.width=p,a.handler.height=q,b.getElement(z[c].index,a.item,z[c].handler);for(c=A.length-1;c>=0;c-=1)a=A[c],a.handler.width=p,a.handler.height=q,j=a.wrapper,j.style.height=q+"px",j.style.width=p+"px"}o._MaxScroll=x*b.getElementsCount()-o._ParentSize,o.setPosition(o.scrollPosition,!0)},u.setPosition=o.setPosition,o.setPosition=function(a,b){clearTimeout(t),u.setPosition.apply(o,arguments),s=window.performance.now(),(s-C>B||b)&&(m(a),C=s),t=setTimeout(f,1e3)},o.refresh(),m(0),o}